<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mark's Casino - High Roller</title>
    <style>
        /* --- General Styling --- */
        :root {
            /* Casino Palette */
            --color-primary: #FFD700; /* Gold */
            --color-secondary: #00bcd4; /* Accent Blue */
            --color-background: #1c1c1c; 
            --color-surface: #2a2a2a; 
            --color-text: #f0f0f0; 
            --color-shadow: rgba(0, 0, 0, 0.7);
        }

        body { 
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; 
            background-color: var(--color-background); 
            color: var(--color-text); 
            padding-top: 150px; /* Increased padding to accommodate fixed navigation */
            padding-bottom: 20px;
            text-align: center;
            background-image: url('data:image:svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="100" height="100" viewBox="0 0 100 100"><rect width="100" height="100" fill="%231c1c1c"/><g fill="none" stroke="%23303030" stroke-width="1.5"><path d="M50 0v100M0 50h100M0 0l100 100M100 0L0 100"/></g></svg>');
            background-size: 50px 50px;
        }
        
        /* --- SITE NAVIGATION/HEADER BAR --- */
        .header-bar {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            background-color: #000000;
            color: var(--color-primary);
            box-shadow: 0 4px 10px var(--color-shadow);
            z-index: 1000;
            padding: 10px 0;
        }
        .header-bar h1 {
            margin: 0;
            font-size: 2.5em;
        }
        
        .nav-bar {
            background-color: #111;
            padding: 10px 0;
            border-top: 1px solid #333;
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            gap: 10px;
        }
        .nav-bar a {
            color: var(--color-secondary);
            text-decoration: none;
            padding: 8px 15px;
            border: 1px solid var(--color-secondary);
            border-radius: 5px;
            transition: background-color 0.2s, color 0.2s;
            font-weight: bold;
        }
        .nav-bar a:hover {
            background-color: var(--color-secondary);
            color: #111;
        }

        /* Balance Container */
        .balance { 
            font-size: 1.6em; 
            padding: 15px 35px; 
            border: 2px solid var(--color-primary); 
            background: linear-gradient(145deg, var(--color-surface), #1a1a1a); 
            border-radius: 15px; 
            display: inline-block;
            box-shadow: 0 6px 20px var(--color-shadow);
            margin-top: 40px; 
        }
        
        /* --- GAME CONTAINER --- */
        .game-container { 
            background-color: var(--color-surface); 
            padding: 30px; 
            margin: 25px auto; 
            border-radius: 15px; 
            box-shadow: 0 5px 15px var(--color-shadow);
            max-width: 800px;
            border-top: 5px solid var(--color-primary); 
            text-align: left;
        }
        
        h2 { 
            color: var(--color-primary); 
            border-bottom: 1px solid #444; 
            padding-bottom: 15px; 
            margin-bottom: 25px; 
            font-size: 2em;
            text-align: center;
        }
        
        /* Game Display Areas (Cards, Hands) */
        .hand-display { 
            display: flex; 
            justify-content: center; 
            gap: 10px; 
            margin-top: 15px; 
            margin-bottom: 25px;
            min-height: 70px; 
            flex-wrap: wrap; 
            align-items: center; 
            text-align: center;
            padding: 15px;
            background-color: #121212; 
            border-radius: 10px;
            border: 1px solid #444;
        }
        
        /* --- Form Elements and Buttons --- */
        .game-controls {
            display: flex;
            justify-content: center;
            align-items: center;
            flex-wrap: wrap; 
            padding-top: 15px;
        }
        
        .bet-control-group {
            display: flex;
            align-items: center;
            margin-right: 15px;
        }

        input[type="number"], select { 
            padding: 12px; 
            border: 1px solid #444; 
            border-radius: 8px; 
            width: 140px;
            background-color: #333;
            color: var(--color-text);
            outline: none;
        }
        
        button { 
            padding: 12px 25px; 
            background-color: var(--color-primary); 
            color: #121212; 
            border: none; 
            border-radius: 8px; 
            cursor: pointer; 
            font-size: 1em; 
            font-weight: bold;
            box-shadow: 0 4px #b8a032; 
            margin: 5px;
            transition: background-color 0.2s, box-shadow 0.2s, transform 0.2s;
        }

        button:active {
            box-shadow: 0 1px #b8a032; 
            transform: translateY(3px);
        }
        
        .max-bet-btn {
            background-color: #555;
            color: white;
            padding: 5px 10px;
            font-size: 0.8em;
            margin-left: -5px; 
            border-radius: 0 8px 8px 0;
            box-shadow: none;
            height: 42px; 
            line-height: 1.5;
            border: 1px solid #444;
            border-left: none;
        }

        /* --- Result Feedback --- */
        .result { 
            margin-top: 25px; 
            font-weight: bold; 
            padding: 15px; 
            border-radius: 10px; 
            font-size: 1.3em;
            opacity: 0; 
            transition: opacity 0.5s ease-in-out;
            text-align: center;
        }
        .result.show { opacity: 1; }
        .win { background-color: #4caf50; color: white; }
        .lose { background-color: #f44336; color: white; }
        .push { background-color: #ff9800; color: #121212; }

        @keyframes jackpot-flash {
            0% { background-color: #4caf50; }
            50% { background-color: #FFD700; color: #121212; }
            100% { background-color: #4caf50; }
        }
        .result.win.jackpot {
            animation: jackpot-flash 0.5s ease-in-out 3;
        }

        /* --- Card Styles (Standard) --- */
        @keyframes dealAnimation {
            0% { transform: translateY(-50px) rotateY(90deg); opacity: 0; }
            50% { opacity: 1; }
            100% { transform: translateY(0) rotateY(0deg); opacity: 1; }
        }
        
        .card { 
            padding: 15px 10px; 
            width: 50px;
            border: 1px solid #777; 
            background-color: #ffffff; 
            border-radius: 8px;
            color: black;
            font-size: 1.3em;
            box-shadow: 0 3px 6px var(--color-shadow);
            opacity: 0; 
            transform: translateY(-50px);
            animation: dealAnimation 0.5s ease-out forwards; 
        }

        .card.hidden {
            background-color: #555;
            color: #555;
            border-color: #333;
            box-shadow: none;
            opacity: 1; 
            animation: none; 
            transform: none;
        }

        /* --- COIN FLIP STYLES (Simple Coin) --- */
        .coin-display {
            display: flex;
            justify-content: center;
            align-items: center;
            height: 150px; 
            margin-bottom: 20px;
        }

        .coin {
            width: 100px;
            height: 100px;
            border-radius: 50%;
            background: linear-gradient(135deg, #FFD700, #DAA520, #FFD700); 
            border: 5px solid #a88b00;
            box-shadow: 0 0 15px rgba(255, 215, 0, 0.7);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2.5em;
            font-weight: bold;
            transition: all 0.1s; 
            transform: rotateY(0deg); 
            color: #1c1c1c;
        }
        
        .coin.flipping {
            animation: simple-flip 0.5s linear infinite alternate;
        }
        @keyframes simple-flip {
            from { opacity: 0.5; transform: scale(1.1); }
            to { opacity: 1; transform: scale(1); }
        }

        /* --- SLOTS BOXES ENHANCEMENT --- */
        .slot-reels {
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 25px 0;
            margin: 20px auto;
            width: 90%;
            background-color: #121212;
            border: 5px solid #555;
            border-radius: 10px;
            box-shadow: inset 0 0 10px #000;
        }
        .reel {
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 3.5em;
            padding: 10px;
            margin: 0 10px;
            width: 80px;
            height: 80px;
            background-color: #333; 
            border: 3px solid var(--color-primary);
            border-radius: 8px;
            color: var(--color-primary);
            font-weight: bold;
            box-shadow: inset 0 0 10px rgba(255, 255, 255, 0.1);
            transition: transform 0.2s;
        }

        /* --- ROULETTE ENHANCEMENT --- */
        .roulette-display-container {
            display: flex;
            justify-content: center;
            margin: 20px 0;
        }
        .roulette-number-display {
            font-size: 3em;
            font-weight: bold;
            padding: 20px 30px;
            border: 5px solid #8B0000; 
            background-color: #121212; 
            color: var(--color-text);
            border-radius: 15px;
            min-width: 150px;
            text-align: center;
            box-shadow: 0 0 15px rgba(255, 0, 0, 0.5);
            transition: all 0.5s;
        }

        .roulette-number-display.RED { color: #f44336; }
        .roulette-number-display.BLACK { color: #555; border-color: #333; box-shadow: 0 0 15px rgba(0, 0, 0, 0.5);}
        .roulette-number-display.GREEN { 
            color: #4caf50; 
            border-color: #4caf50; 
            box-shadow: 0 0 15px rgba(76, 175, 80, 0.8);
        }

        /* --- Land Mines Styles (Simple) --- */
        .mine-grid {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 5px;
            width: 350px; 
            margin: 20px auto;
        }

        .mine-cell {
            width: 60px;
            height: 60px;
            background-color: #333; 
            border: 2px solid #555;
            border-radius: 5px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2em;
            color: var(--color-text);
            cursor: pointer;
            user-select: none;
            transition: background-color 0.1s;
            font-weight: bold;
        }

        .mine-cell.safe { background-color: #12803c; color: white; cursor: default; }
        .mine-cell.mine { background-color: #8B0000; color: white; cursor: default; }
    </style>
</head>
<body>

    <div class="header-bar">
        <h1>üí∞ Mark's Casino üí∞</h1>
        <div class="nav-bar">
            <a href="#loreSection">‚ú® Casino Lore</a>
            <a href="#landMines">üí£ Mines</a>
            <a href="#coinFlip">ü•á Coin Flip</a>
            <a href="#blackjack">‚ô†Ô∏è Blackjack</a>
            <a href="#slots">üé∞ Slots</a>
            <a href="#roulette">üî¥ Roulette</a>
            <a href="#poker">üÉè Poker</a>
        </div>
    </div>

    <div class="balance-container">
        <div class="balance">
            Current Balance: <span id="balance">1000</span> Credits
        </div>
    </div>

    <hr>

    <div class="game-container" id="landMines">
        <h2>Land Mines üí£</h2>
        <p style="text-align:center;">
            Click to reveal cash multipliers! Avoid the mines. Cash out anytime.
        </p>
        
        <div id="mineGrid" class="mine-grid">
            </div>

        <div class="game-controls">
            <label for="minesBet">Bet Amount:</label>
            <div class="bet-control-group">
                <input type="number" id="minesBet" value="100" min="10">
                <button class="max-bet-btn" onclick="setMaxBet('mines')">MAX</button>
            </div>
            <label for="mineCount" style="margin-left: 15px;">Mines:</label>
            <select id="mineCount" style="width:100px; margin-right: 15px;">
                <option value="3">3 Mines</option>
                <option value="5">5 Mines</option>
                <option value="8">8 Mines</option>
            </select>
            <button id="minesStartButton" onclick="startNewMinesGame()">Start Game</button>
            <button id="minesCashOutButton" onclick="cashOutMines()" disabled style="background-color: #4CAF50;">Cash Out ($0)</button>
        </div>
        <div id="minesResult" class="result"></div>
    </div>

    <hr>

    <div class="game-container" id="coinFlip">
        <h2>Heads or Tails ü•á</h2>
        <p style="text-align:center;">Standard Payout 2x. Edge Payout 50x (1 in 100 chance).</p>
        
        <div class="coin-display">
            <div id="coin" class="coin">?</div>
        </div>
        
        <div class="game-controls">
            <label for="coinBet">Bet Amount:</label>
            <div class="bet-control-group">
                <input type="number" id="coinBet" value="100" min="10">
                <button class="max-bet-btn" onclick="setMaxBet('coin')">MAX</button>
            </div>
            <select id="coinSelection" style="width:140px; margin:5px;">
                <option value="Heads">Heads (2x)</option>
                <option value="Tails">Tails (2x)</option>
                <option value="Edge">Edge (50x)</option>
            </select>
            <button id="coinButton" onclick="playCoinFlip()">Flip Coin</button>
        </div>
        <div id="coinFlipResult" class="result"></div>
    </div>

    <hr>

    <div class="game-container" id="blackjack">
        <h2>Blackjack 21 ‚ô†Ô∏è</h2>
        <div class="hand-display">
            <span>Dealer Hand</span> (<span id="dealerScore">--</span>): <span id="dealerHand">--</span>
        </div>
        <div class="hand-display">
            <span>Your Hand</span> (<span id="playerScore">--</span>): <span id="playerHand">--</span>
        </div>
        <div class="game-controls">
            <label for="blackjackBet">Bet Amount:</label>
            <div class="bet-control-group">
                <input type="number" id="blackjackBet" value="100" min="10">
                <button class="max-bet-btn" onclick="setMaxBet('blackjack')">MAX</button>
            </div>
            <button id="dealButton" onclick="dealBlackjack()">Deal</button>
            <button id="hitButton" onclick="hit()" disabled>Hit</button>
            <button id="standButton" onclick="stand()" disabled>Stand</button>
        </div>
        <div id="blackjackResult" class="result"></div>
    </div>

    <hr>

    <div class="game-container" id="slots">
        <h2>Lucky Slots üé∞</h2>
        <div class="slot-reels">
            <div id="reel1" class="reel">?</div>
            <div id="reel2" class="reel">?</div>
            <div id="reel3" class="reel">?</div>
        </div>
        
        <p style="text-align:center; color:#999; margin-top:0;">
            Match 3 symbols to win big! Different symbols offer different multipliers.
        </p>

        <div class="game-controls">
            <label for="slotBet">Bet Amount:</label>
            <div class="bet-control-group">
                <input type="number" id="slotBet" value="100" min="10">
                <button class="max-bet-btn" onclick="setMaxBet('slot')">MAX</button>
            </div>
            <button id="slotButton" onclick="playSlots()">Spin Reels</button>
        </div>
        <div id="slotResult" class="result"></div>
    </div>

    <hr>

    <div class="game-container" id="roulette">
        <h2>Grand Roulette (0-12) üü¢üî¥‚ö´</h2>
        
        <div class="roulette-display-container">
            <div id="rouletteNumberDisplay" class="roulette-number-display">--</div>
        </div>

        <div class="game-controls">
            <label for="rouletteBet">Bet Amount:</label>
            <div class="bet-control-group">
                <input type="number" id="rouletteBet" value="100" min="10">
                <button class="max-bet-btn" onclick="setMaxBet('roulette')">MAX</button>
            </div>
            <select id="rouletteSelection" style="width:200px; margin:5px;">
                <optgroup label="Single Number (12x)">
                    <option value="num1">Number 1</option>
                    <option value="num7">Number 7</option>
                </optgroup>
                <optgroup label="Column Bets (3x)">
                    <option value="col1">Column 1 (1, 2, 3, 4)</option>
                    <option value="col2">Column 2 (5, 6, 7, 8)</option>
                    <option value="col3">Column 3 (9, 10, 11, 12)</option>
                </optgroup>
                <optgroup label="Even Money (2x)">
                    <option value="green">Green (0) - 13x</option>
                    <option value="red">Red (1, 3, 5, 7, 9, 11)</option>
                    <option value="black">Black (2, 4, 6, 8, 10, 12)</option>
                    <option value="odd">Odd (1, 3, 5, 7, 9, 11)</option>
                    <option value="even">Even (2, 4, 6, 8, 10, 12)</option>
                    <option value="low">Low (1-6)</option>
                    <option value="high">High (7-12)</option>
                </optgroup>
            </select>
            <button id="rouletteButton" onclick="playRoulette()">Spin Wheel</button>
        </div>
        <div id="rouletteResult" class="result"></div>
    </div>

    <hr>

    <div class="game-container" id="poker">
        <h2>Classic 5-Card Draw Poker üÉè</h2>
        <p style="text-align:center;">Goal: Beat the Dealer's hand rank!</p>

        <p style="text-align:center; color:#999; margin-top:0;">
            Winning hands receive payouts based on hand rarity (Pair 2x up to Straight Flush 20x).
        </p>

        <div class="hand-display" id="playerPokerHand"><span>Your Hand</span>: --</div>
        <div class="hand-display" id="dealerPokerHand"><span>Dealer Hand</span>: --</div>
        <div class="game-controls">
            <label for="pokerBet">Bet Amount:</label>
            <div class="bet-control-group">
                <input type="number" id="pokerBet" value="100" min="10">
                <button class="max-bet-btn" onclick="setMaxBet('poker')">MAX</button>
            </div>
            <button id="pokerButton" onclick="playPoker()">Deal Cards</button>
        </div>
        <div id="pokerResult" class="result"></div>
    </div>

    <hr>

    <div class="game-container" id="loreSection">
        <h2>Casino Lore: Mark's Existential Bet üî¥</h2>
        <div style="text-align: center; max-width: 600px; margin: 0 auto; line-height: 1.6;">
            <p>This entire, highly questionable operation started with a <strong>whim and zero plannin</stong>. The founder, <strong>Mark</strong>, was simply trying to find a project more interesting than his own life. The concept wasn't born from genius or ambition, but from a reckless compulsion.</p>
            <p>Mark built this casino to mirror his own life philosophy: **bet everything on Red**. He runs the code like a perpetually drunk high-roller, constantly losing faith in the algorithms, tweaking the payouts at random, and often losing more to the House than any player.</p>
            
            <p style="color: #ff9800; font-weight: bold; margin-top: 20px;">
                <span style="font-size: 1.2em;">üö® Terms & Conditions (Mark's Version) üö®</span><br>
                We legally advise you to "follow the rules." They were drafted by <strong>Mark</strong> using only a magic eight ball, a vague memory of a children's board game, and the philosophical question, "What is gambling, really?" <strong> NOT try to exploit the code.</strong> Not because it's wrong, but because if Mark catches you, he'll replace your entire balance with a single ü•î emoji. You have been warned.
            </p>
            
            <div id="termsPrompt" style="margin-top: 30px; padding: 15px; border: 2px solid var(--color-secondary); border-radius: 10px;">
                <p style="font-weight: bold; font-size: 1.1em; color: var(--color-secondary);">
                    Do you accept Mark's Chaos Rule Terms & Conditions?
                </p>
                <button onclick="handleTermsAcceptance(true)" style="background-color: #4CAF50; color: white;">Accept Terms</button>
                <button onclick="handleTermsAcceptance(false)" style="background-color: #f44336; margin-left: 10px; color: white;">Decline Terms</button>
            </div>
            
            <div id="termsStatus" style="margin-top: 20px; font-weight: bold; min-height: 20px;"></div>

            <p style="color: var(--color-primary); font-weight: bold; font-style: italic; margin-top: 20px;">
                Mark is the bank, the source of the chaos, and the house's worst player. Remember that the code is held together by pure despair and the faint hope that the next spin will finally land on black‚Äîfor him.
            </p>
        </div>
    </div>

    <script>
        let balance = 1000;
        const balanceDisplay = document.getElementById('balance');
        const suits = ['‚ô†Ô∏è', '‚ô•Ô∏è', '‚ô¶Ô∏è', '‚ô£Ô∏è'];
        const cardValues = ['2', '3', '4', '5', '6', '7', '8', '9', '10', 'J', 'Q', 'K', 'A'];
        const rankMap = { '2': 2, '3': 3, '4': 4, '5': 5, '6': 6, '7': 7, '8': 8, '9': 9, '10': 10, 'J': 11, 'Q': 12, 'K': 13, 'A': 14 };
        
        let termsDeclined = false;

        // --- NEW TERMS ACCEPTANCE LOGIC ---
        function handleTermsAcceptance(accepted) {
            const promptDiv = document.getElementById('termsPrompt');
            const statusDiv = document.getElementById('termsStatus');
            const allGameInputs = document.querySelectorAll('input[type="number"], select');
            
            promptDiv.style.display = 'none';

            if (accepted) {
                statusDiv.innerHTML = '<span style="color: #4CAF50;">‚úÖ <strong>Terms Accepted:</strong> Welcome to the Chaos. Play responsibly (Mark won\'t).</span>';
                // Everything remains active.
            } else {
                termsDeclined = true;
                
                // 1. Lock the balance to a potato emoji
                const balanceDiv = document.querySelector('.balance');
                balanceDiv.innerHTML = 
                    'Current Balance: <span style="font-size: 1.2em;">ü•î</span><br><strong>CASINO LOCKED.</strong> You declined Mark\'s terms and have been judged.';
                
                // 2. Disable all buttons and inputs
                document.querySelectorAll('button').forEach(btn => {
                    btn.disabled = true;
                });
                allGameInputs.forEach(input => {
                    input.disabled = true;
                });
                
                // 3. Disable mine grid clicks
                document.querySelectorAll('.mine-cell').forEach(cell => cell.onclick = null);

                statusDiv.innerHTML = '<span style="color: #f44336; font-size: 1.2em;">‚ùå <strong>DECLINED:</strong> You failed the existential test. Mark has replaced your balance with a ü•î and locked the casino.</span>';
            }
        }


        // --- Log and Balance Functions ---

        function updateBalance(amount) { 
            if (termsDeclined) return; // Prevent any balance change if terms are declined
            
            balance += amount;
            balanceDisplay.textContent = balance.toLocaleString();

            if (balance < 10) {
                document.querySelectorAll('button').forEach(btn => {
                    if (!btn.classList.contains('max-bet-btn')) btn.disabled = true;
                });
                balanceDisplay.textContent += " (OUT OF CREDITS! Refresh to restart)";
            } else {
                 document.getElementById('slotButton').disabled = false;
                 document.getElementById('rouletteButton').disabled = false;
                 document.getElementById('pokerButton').disabled = false;
                 document.getElementById('dealButton').disabled = false;
                 document.getElementById('coinButton').disabled = false;
                 document.getElementById('minesStartButton').disabled = false;
            }
        }
        
        // --- Utility Functions ---

        function setMaxBet(gameId) {
            const betInput = document.getElementById(`${gameId}Bet`);
            const maxBet = Math.max(10, balance); 
            betInput.value = maxBet;
        }

        function showResult(div, message, type, isJackpot = false) {
            message = message.replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>');
            div.innerHTML = message;
            div.className = `result ${type} show ${isJackpot ? 'jackpot' : ''}`;
            setTimeout(() => {
                div.classList.remove('show');
                div.classList.remove('jackpot');
            }, 5000); 
        }

        function disableButtons(disabled) {
            if (termsDeclined && disabled === false) return; // Prevent re-enabling if declined
            
            document.getElementById('slotButton').disabled = disabled;
            document.getElementById('rouletteButton').disabled = disabled;
            document.getElementById('pokerButton').disabled = disabled;
            document.getElementById('dealButton').disabled = disabled;
            document.getElementById('coinButton').disabled = disabled;
            document.getElementById('minesStartButton').disabled = disabled; 
            document.getElementById('minesCashOutButton').disabled = disabled; 
        }

        function createDeck() {
            const deck = [];
            for (const suit of suits) {
                for (const value of cardValues) {
                    let rank = rankMap[value] || 10;
                    let blackjackRank = (value === 'A') ? 11 : rank; 
                    deck.push({ value: value, suit: suit, rank: rank, blackjackRank: blackjackRank });
                }
            }
            return deck;
        }

        function dealCard(deck) {
            const randomIndex = Math.floor(Math.random() * deck.length);
            return deck.splice(randomIndex, 1)[0];
        }

        // --- LAND MINES LOGIC ---
        const MINE_GRID_SIZE = 25;
        let mineLocations = [];
        let revealedCount = 0;
        let isMineGameActive = false;
        let currentMultiplier = 1.0;
        let currentBet = 0;

        function getNextMultiplier(mines, revealed) {
            if (revealed === 0) return 1.0; 
            let multi = 1.0;
            for (let i = 0; i < revealed; i++) {
                const probSafe = (MINE_GRID_SIZE - mines - i) / (MINE_GRID_SIZE - i);
                multi *= (1 / probSafe);
            }
            return parseFloat(multi.toFixed(2));
        }

        function getExpectedNextMultiplier(mines, revealed) {
            const currentSafe = MINE_GRID_SIZE - mines - revealed;
            const totalRemaining = MINE_GRID_SIZE - revealed;
            
            if (currentSafe === 0) return 0;
            const nextMulti = totalRemaining / currentSafe;
            return parseFloat(nextMulti.toFixed(2));
        }

        function startNewMinesGame() {
            const betInput = document.getElementById('minesBet');
            const resultDiv = document.getElementById('minesResult');
            const minesStartButton = document.getElementById('minesStartButton');
            const minesCashOutButton = document.getElementById('minesCashOutButton');
            
            const bet = parseInt(betInput.value);
            const mineCount = parseInt(document.getElementById('mineCount').value);

            if (bet > balance || bet <= 0) {
                showResult(resultDiv, 'Invalid bet or insufficient balance!', 'lose');
                return;
            }
            if (isMineGameActive) return;

            currentBet = bet;
            updateBalance(-bet);
            isMineGameActive = true;
            revealedCount = 0;
            currentMultiplier = 1.0;
            disableButtons(true);
            minesStartButton.disabled = true;
            minesCashOutButton.disabled = true;
            minesCashOutButton.textContent = 'Cash Out ($0)';
            resultDiv.classList.remove('show');
            document.getElementById('mineCount').disabled = true;

            mineLocations = [];
            const allSpots = Array.from({ length: MINE_GRID_SIZE }, (_, i) => i);
            for (let i = 0; i < mineCount; i++) {
                const randomIndex = Math.floor(Math.random() * allSpots.length);
                mineLocations.push(allSpots.splice(randomIndex, 1)[0]);
            }

            const gridDiv = document.getElementById('mineGrid');
            gridDiv.innerHTML = '';
            for (let i = 0; i < MINE_GRID_SIZE; i++) {
                const cell = document.createElement('div');
                cell.className = 'mine-cell';
                cell.setAttribute('data-index', i);
                cell.onclick = revealCell;
                gridDiv.appendChild(cell);
            }
        }
        
        function revealCell(event) {
            if (!isMineGameActive) return;
            
            const cell = event.currentTarget;
            if (cell.classList.contains('safe') || cell.classList.contains('mine')) return;
            
            const index = parseInt(cell.getAttribute('data-index'));
            const resultDiv = document.getElementById('minesResult');
            const mineCount = parseInt(document.getElementById('mineCount').value);

            if (mineLocations.includes(index)) {
                cell.classList.add('mine');
                cell.textContent = 'üí£';
                endMinesGame(false, `BOOM! You hit a mine at position ${index + 1}. You lost your bet.`);
            } else {
                revealedCount++;
                
                currentMultiplier = getNextMultiplier(mineCount, revealedCount); 
                const nextExpectedMulti = getExpectedNextMultiplier(mineCount, revealedCount);
                
                cell.classList.add('safe');
                cell.textContent = `x${currentMultiplier.toFixed(2)}`; 
                cell.onclick = null; 

                const potentialWin = Math.floor(currentBet * currentMultiplier);
                
                document.getElementById('minesCashOutButton').disabled = false;
                document.getElementById('minesCashOutButton').textContent = `Cash Out ($${potentialWin.toLocaleString()})`;

                showResult(resultDiv, `‚úÖ Safe! Current Winnings: <strong>${currentMultiplier.toFixed(2)}x</strong>. Next potential multiplier: x${nextExpectedMulti.toFixed(2)}.`, 'win');
                
                if (revealedCount === (MINE_GRID_SIZE - mineCount)) {
                     endMinesGame(true, `PERFECT GAME! You revealed all ${revealedCount} safe tiles!`, potentialWin);
                }
            }
        }
        
        function cashOutMines() {
            const win = Math.floor(currentBet * currentMultiplier);
            endMinesGame(true, `CASHED OUT at <strong>${currentMultiplier.toFixed(2)}x</strong>! You won <strong>${win.toLocaleString()}</strong> Credits!`, win);
        }

        function endMinesGame(isWin, message, finalWin = 0) {
            isMineGameActive = false;
            disableButtons(false);
            document.getElementById('minesStartButton').disabled = false;
            document.getElementById('minesCashOutButton').disabled = true;
            document.getElementById('minesCashOutButton').textContent = 'Cash Out ($0)';
            document.getElementById('mineCount').disabled = false;

            const allCells = document.getElementById('mineGrid').children;
            mineLocations.forEach(index => {
                if (!allCells[index].classList.contains('mine')) {
                    allCells[index].classList.add('mine');
                    allCells[index].textContent = 'üí£';
                }
            });
            
            if (isWin) {
                updateBalance(finalWin);
                showResult(document.getElementById('minesResult'), message, 'win', finalWin >= 1000); 
            } else {
                showResult(document.getElementById('minesResult'), message, 'lose');
            }
            
            document.querySelectorAll('.mine-cell').forEach(cell => cell.onclick = null);
        }


        // --- COIN FLIP LOGIC (REVERTED/SIMPLE) ---
        async function playCoinFlip() {
            const betInput = document.getElementById('coinBet');
            const bet = parseInt(betInput.value);
            const selection = document.getElementById('coinSelection').value;
            const resultDiv = document.getElementById('coinFlipResult');
            const coin = document.getElementById('coin');

            if (bet > balance || bet <= 0) {
                showResult(resultDiv, 'Invalid bet or insufficient balance!', 'lose');
                return;
            }
            disableButtons(true);
            updateBalance(-bet);
            
            coin.textContent = '?';
            coin.style.backgroundColor = '';
            coin.classList.add('flipping');

            await new Promise(resolve => setTimeout(resolve, 2000)); 

            coin.classList.remove('flipping');
            
            // Determine result (1 in 100 chance for Edge)
            let result;
            const roll = Math.floor(Math.random() * 100) + 1; // 1 to 100
            
            if (roll === 1) {
                result = 'Edge';
                coin.textContent = 'E';
                coin.style.backgroundColor = '#8B0000';
            } else {
                result = (Math.random() < 0.5) ? 'Heads' : 'Tails';
                coin.textContent = (result === 'Heads') ? 'H' : 'T';
                coin.style.backgroundColor = ''; 
            }

            let win = 0;
            let message = '';
            let type = 'lose';
            let payout = 0;

            if (selection === 'Edge' && result === 'Edge') {
                payout = 50;
            } else if ((selection === 'Heads' || selection === 'Tails') && selection === result) {
                payout = 2;
            }

            if (payout > 0) {
                win = bet * payout;
                message = `üéâ The coin landed on <strong>${result}</strong>! You won <strong>${win.toLocaleString()}</strong> Credits! (${payout}x)`;
                type = 'win';
            } else {
                message = `The coin landed on <strong>${result}</strong>. You lost.`;
                type = 'lose';
            }

            updateBalance(win);
            disableButtons(false);
            showResult(resultDiv, message, type, payout >= 50);
        }

        // --- BLACKJACK LOGIC ---
        let blackjackDeck = [];
        let playerHand = [];
        let dealerHand = [];
        
        function getScore(hand) {
            let score = hand.reduce((sum, card) => sum + card.blackjackRank, 0);
            let aces = hand.filter(card => card.value === 'A').length;
            while (score > 21 && aces > 0) {
                score -= 10;
                aces--;
            }
            return score;
        }

        function renderHands(hideDealerSecondCard = false) {
            const playerDiv = document.getElementById('playerHand');
            const dealerDiv = document.getElementById('dealerHand');
            const playerScoreSpan = document.getElementById('playerScore');
            const dealerScoreSpan = document.getElementById('dealerScore');

            playerDiv.querySelectorAll('.card').forEach(c => c.remove());
            dealerDiv.querySelectorAll('.card').forEach(c => c.remove());

            playerHand.forEach((card, index) => {
                const pCard = document.createElement('span');
                pCard.className = 'card';
                pCard.style.color = (card.suit === '‚ô•Ô∏è' || card.suit === '‚ô¶Ô∏è') ? 'red' : 'black';
                pCard.textContent = `${card.value}${card.suit}`;
                pCard.style.animationDelay = `${index * 0.2}s`; 
                playerDiv.appendChild(pCard);
            });
            playerScoreSpan.textContent = getScore(playerHand);

            dealerHand.forEach((card, index) => {
                const dCard = document.createElement('span');
                dCard.className = 'card';
                dCard.style.animationDelay = `${index * 0.2}s`; 
                
                if (hideDealerSecondCard && index === 1) {
                    dCard.classList.add('hidden');
                    dCard.textContent = 'üÉè';
                    dCard.style.color = '#555'; 
                } else {
                    dCard.style.color = (card.suit === '‚ô•Ô∏è' || card.suit === '‚ô¶Ô∏è') ? 'red' : 'black';
                    dCard.textContent = `${card.value}${card.suit}`;
                }
                dealerDiv.appendChild(dCard);
            });

            if (hideDealerSecondCard && dealerHand.length > 0) {
                const visibleCard = dealerHand[0];
                dealerScoreSpan.textContent = visibleCard.value === 'A' ? '11/1' : visibleCard.blackjackRank;
            } else {
                dealerScoreSpan.textContent = getScore(dealerHand);
            }
        }

        async function dealBlackjack() {
            const betInput = document.getElementById('blackjackBet');
            const bet = parseInt(betInput.value);
            const resultDiv = document.getElementById('blackjackResult');

            if (bet > balance || bet <= 0) {
                showResult(resultDiv, 'Invalid bet or insufficient balance!', 'lose');
                return;
            }
            disableButtons(true);
            document.getElementById('hitButton').disabled = true;
            document.getElementById('standButton').disabled = true;
            updateBalance(-bet);

            blackjackDeck = createDeck();
            playerHand = [];
            dealerHand = [];
            resultDiv.classList.remove('show');
            document.getElementById('playerScore').textContent = '--';
            document.getElementById('dealerScore').textContent = '--';
            document.getElementById('playerHand').innerHTML = ''; 
            document.getElementById('dealerHand').innerHTML = ''; 

            for (let i = 0; i < 2; i++) {
                playerHand.push(dealCard(blackjackDeck));
                dealerHand.push(dealCard(blackjackDeck));
            }
            renderHands(true);
            
            await new Promise(resolve => setTimeout(resolve, 500)); 

            disableButtons(false); 
            document.getElementById('dealButton').disabled = false;

            if (getScore(playerHand) === 21) {
                showResult(resultDiv, '<strong>BLACKJACK!</strong> Waiting for Dealer...', 'win');
                await stand(true);
            } else {
                document.getElementById('dealButton').disabled = true; 
                document.getElementById('hitButton').disabled = false;
                document.getElementById('standButton').disabled = false;
            }
        }

        async function hit() {
            disableButtons(true);
            document.getElementById('hitButton').disabled = true;
            document.getElementById('standButton').disabled = true;
            
            playerHand.push(dealCard(blackjackDeck));
            renderHands(true);
            
            await new Promise(resolve => setTimeout(resolve, 500));

            const score = getScore(playerHand);
            if (score > 21) {
                showResult(document.getElementById('blackjackResult'), `<strong>BUST!</strong> Score: ${score}. You lose.`, 'lose');
                disableButtons(false);
                document.getElementById('dealButton').disabled = false;
            } else if (score === 21) {
                showResult(document.getElementById('blackjackResult'), `<strong>21!</strong> Waiting for Dealer...`, 'win');
                await stand(true);
            } else {
                disableButtons(false); 
                document.getElementById('dealButton').disabled = true;
                document.getElementById('hitButton').disabled = false;
                document.getElementById('standButton').disabled = false;
            }
        }

        async function stand(auto = false) {
            disableButtons(true);
            document.getElementById('hitButton').disabled = true;
            document.getElementById('standButton').disabled = true;
            
            const bet = parseInt(document.getElementById('blackjackBet').value);
            const resultDiv = document.getElementById('blackjackResult');
            const playerScore = getScore(playerHand);

            renderHands(false);
            await new Promise(resolve => setTimeout(resolve, 1000)); 

            let dealerScore = getScore(dealerHand);
            while (dealerScore < 17) {
                dealerHand.push(dealCard(blackjackDeck));
                renderHands(false);
                await new Promise(resolve => setTimeout(resolve, 1000));
                dealerScore = getScore(dealerHand);
            }

            let message = '';
            let type = '';
            let win = 0;

            if (playerScore > 21) {
                // Already lost on Bust
            } else if (dealerScore > 21) {
                win = bet * 2;
                message = `Dealer <strong>BUSTED</strong> (${dealerScore})! You win ${bet} Credits! Total: ${win.toLocaleString()}`;
                type = 'win';
            } else if (playerScore > dealerScore) {
                win = bet * 2;
                message = `You win! (${playerScore} to ${dealerScore}). Total: ${win.toLocaleString()}`;
                type = 'win';
            } else if (playerScore < dealerScore) {
                message = `Dealer wins (${dealerScore} to ${playerScore}). You lose.`;
                type = 'lose';
            } else {
                win = bet;
                message = `<strong>PUSH</strong> (${playerScore} to ${dealerScore}). Bet returned.`;
                type = 'push';
            }
            
            updateBalance(win); 
            showResult(resultDiv, message, type);
            disableButtons(false);
            document.getElementById('dealButton').disabled = false;
        }
        
        // --- SLOT MACHINE LOGIC ---
        const weightedSymbols = [
            'üçí', 'üçí', 'üçí', 'üçí', 'üçí', 'üçí', 'üçí', 'üçí', 'üçí', 'üçí', 
            'üçã', 'üçã', 'üçã', 'üçã', 'üçã', 'üçã', 'üçã', 
            'üîî', 'üîî', 'üîî', 'üîî', 'üîî', 
            'üí∞', 'üí∞', 'üí∞', 
            'üíé', 'üíé', 
            'üÉè' 
        ];
        
        const slotPayouts = {
            'üçí': 5, 'üçã': 8, 'üîî': 15, 'üí∞': 50, 'üíé': 100, 'üÉè': 100 
        };

        function getWeightedResult() {
             const index = Math.floor(Math.random() * weightedSymbols.length);
             return weightedSymbols[index];
        }
        
        async function playSlots() {
            const betInput = document.getElementById('slotBet');
            const bet = parseInt(betInput.value);
            const resultDiv = document.getElementById('slotResult');
            const reels = [document.getElementById('reel1'), document.getElementById('reel2'), document.getElementById('reel3')];

            if (bet > balance || bet <= 0) {
                showResult(resultDiv, 'Invalid bet or insufficient balance!', 'lose');
                return;
            }
            disableButtons(true);
            updateBalance(-bet);

            reels.forEach(r => r.textContent = '...');
            await new Promise(resolve => setTimeout(resolve, 1500)); 

            const results = [
                getWeightedResult(),
                getWeightedResult(),
                getWeightedResult()
            ];

            reels[0].textContent = results[0];
            await new Promise(resolve => setTimeout(resolve, 200));
            reels[1].textContent = results[1];
            await new Promise(resolve => setTimeout(resolve, 200));
            reels[2].textContent = results[2];

            let win = 0;
            let message = '';
            let type = 'lose';
            let isJackpot = false;

            if (results[0] === results[1] && results[1] === results[2]) {
                const symbol = results[0];
                const multiplier = slotPayouts[symbol] || 0;
                win = bet * multiplier;
                message = `üéâ <strong>JACKPOT!</strong> THREE ${symbol}'s! You won <strong>${win.toLocaleString()}</strong> Credits! (${multiplier}x)`;
                type = 'win';
                if (multiplier >= 50) isJackpot = true; 
            } 
            else if (results[0] === results[1] || results[0] === results[2] || results[1] === results[2]) {
                win = bet * 2;
                message = `Double Match! You won <strong>${win.toLocaleString()}</strong> Credits! (2x)`;
                type = 'win';
            } else {
                message = `You spun: ${results.join(' | ')}. You lost!`;
                type = 'lose';
            }

            updateBalance(win);
            showResult(resultDiv, message, type, isJackpot);
            disableButtons(false);
            document.getElementById('dealButton').disabled = false;
        }

        // --- ROULETTE LOGIC ---
        const redNumbers = [1, 3, 5, 7, 9, 11];
        const blackNumbers = [2, 4, 6, 8, 10, 12];

        const rouletteSegments = [{ number: 0, color: 'GREEN', class: 'roulette-green-text' }]; 
        for (let i = 1; i <= 12; i++) {
            rouletteSegments.push({
                number: i,
                color: redNumbers.includes(i) ? 'RED' : 'BLACK',
                class: redNumbers.includes(i) ? 'roulette-red-text' : 'roulette-black-text' 
            });
        }

        const rouletteNumberDisplay = document.getElementById('rouletteNumberDisplay');

        async function playRoulette() {
            const betInput = document.getElementById('rouletteBet');
            const bet = parseInt(betInput.value);
            const selection = document.getElementById('rouletteSelection').value;
            const resultDiv = document.getElementById('rouletteResult');

            if (bet > balance || bet <= 0) {
                showResult(resultDiv, 'Invalid bet or insufficient balance!', 'lose');
                return;
            }
            disableButtons(true);
            updateBalance(-bet);

            rouletteNumberDisplay.textContent = "Spinning...";
            rouletteNumberDisplay.className = 'roulette-number-display';
            
            await new Promise(resolve => setTimeout(resolve, 3000)); 
            
            const resultNumberIndex = Math.floor(Math.random() * rouletteSegments.length); 
            const finalSegment = rouletteSegments[resultNumberIndex];
            const resultNumber = finalSegment.number;
            const finalColor = finalSegment.color;

            rouletteNumberDisplay.textContent = resultNumber;
            rouletteNumberDisplay.classList.add(finalColor);
            
            let win = 0;
            let message = '';
            let type = 'lose';
            let isWin = false;
            let payout = 0; 
            let winDescription = ''; 

            switch (selection) {
                case 'green':
                    if (resultNumber === 0) { isWin = true; payout = 13; winDescription = 'Green (0)'; }
                    break;
                case 'num1':
                    if (resultNumber === 1) { isWin = true; payout = 12; winDescription = 'Number 1'; }
                    break;
                case 'num7':
                    if (resultNumber === 7) { isWin = true; payout = 12; winDescription = 'Number 7'; }
                    break;
                case 'col1': 
                    if (resultNumber >= 1 && resultNumber <= 4) { isWin = true; payout = 3; winDescription = 'Column 1 (1-4)'; }
                    break;
                case 'col2': 
                    if (resultNumber >= 5 && resultNumber <= 8) { isWin = true; payout = 3; winDescription = 'Column 2 (5-8)'; }
                    break;
                case 'col3': 
                    if (resultNumber >= 9 && resultNumber <= 12) { isWin = true; payout = 3; winDescription = 'Column 3 (9-12)'; }
                    break;
                case 'red':
                    if (redNumbers.includes(resultNumber)) { isWin = true; payout = 2; winDescription = 'Red'; }
                    break;
                case 'black':
                    if (blackNumbers.includes(resultNumber)) { isWin = true; payout = 2; winDescription = 'Black'; }
                    break;
                case 'odd':
                    if (resultNumber !== 0 && resultNumber % 2 !== 0) { isWin = true; payout = 2; winDescription = 'Odd'; }
                    break;
                case 'even':
                    if (resultNumber !== 0 && resultNumber % 2 === 0) { isWin = true; payout = 2; winDescription = 'Even'; }
                    break;
                case 'low':
                    if (resultNumber >= 1 && resultNumber <= 6) { isWin = true; payout = 2; winDescription = 'Low (1-6)'; }
                    break;
                case 'high':
                    if (resultNumber >= 7 && resultNumber <= 12) { isWin = true; payout = 2; winDescription = 'High (7-12)'; }
                    break;
            }
            
            if (isWin) {
                win = bet * payout;
                message = `The number is <strong>${resultNumber}</strong>. üèÜ You won on ${winDescription}! Payout: <strong>${payout}x</strong>. Total: <strong>${win.toLocaleString()}</strong> Credits.`;
                type = 'win';
            } else {
                 if (resultNumber === 0 && selection !== 'green') {
                     message = `The number is <strong>0 (${finalColor})</strong>. House wins! You lost.`;
                 } else {
                     message = `The number is <strong>${resultNumber} (${finalColor})</strong>. You lost.`;
                 }
                 type = 'lose';
            }

            updateBalance(win);
            showResult(resultDiv, message, type);
            disableButtons(false);
            document.getElementById('dealButton').disabled = false;
        }

        // --- POKER LOGIC ---
        const pokerRanks = {
            'Straight Flush': 8, 'Four of a Kind': 7, 'Full House': 6, 'Flush': 5, 'Straight': 4,
            'Three of a Kind': 3, 'Two Pair': 2, 'Pair': 1, 'High Card': 0
        };

        function getHandRank(hand) {
            hand.sort((a, b) => a.rank - b.rank); 
            
            const valueCounts = {};
            const suitCounts = {};
            for (const card of hand) {
                valueCounts[card.rank] = (valueCounts[card.rank] || 0) + 1;
                suitCounts[card.suit] = (suitCounts[card.suit] || 0) + 1;
            }

            const counts = Object.values(valueCounts).sort((a, b) => b - a);
            const distinctValues = Object.keys(valueCounts).map(Number).sort((a, b) => b - a);

            const isFlush = Object.values(suitCounts).some(count => count >= 5);
            
            let isStraight = false;
            if (distinctValues.length >= 5) {
                if (distinctValues[0] - distinctValues[4] === 4) {
                    isStraight = true;
                } else if (distinctValues.includes(14) && distinctValues.includes(5) && distinctValues.includes(4) && distinctValues.includes(3) && distinctValues.includes(2)) {
                    isStraight = true;
                }
            }

            let rank = 'High Card';
            if (isStraight && isFlush) rank = 'Straight Flush';
            else if (counts[0] === 4) rank = 'Four of a Kind';
            else if (counts[0] === 3 && counts[1] === 2) rank = 'Full House';
            else if (isFlush) rank = 'Flush';
            else if (isStraight) rank = 'Straight';
            else if (counts[0] === 3) rank = 'Three of a Kind';
            else if (counts[0] === 2 && counts[1] === 2) rank = 'Two Pair';
            else if (counts[0] === 2) rank = 'Pair';

            return { rank, value: pokerRanks[rank], handValues: distinctValues };
        }

        function compareHands(playerHandRank, dealerHandRank) {
            if (playerHandRank.value > dealerHandRank.value) return 1;
            if (playerHandRank.value < dealerHandRank.value) return -1;
            
            for (let i = 0; i < playerHandRank.handValues.length; i++) {
                if (playerHandRank.handValues[i] > dealerHandRank.handValues[i]) return 1;
                if (playerHandRank.handValues[i] < dealerHandRank.handValues[i]) return -1;
            }

            return 0;
        }

        async function playPoker() {
            const betInput = document.getElementById('pokerBet');
            const bet = parseInt(betInput.value);
            const resultDiv = document.getElementById('pokerResult');
            const playerHandDiv = document.getElementById('playerPokerHand');
            const dealerHandDiv = document.getElementById('dealerPokerHand');

            if (bet > balance || bet <= 0) {
                showResult(resultDiv, 'Invalid bet or insufficient balance!', 'lose');
                return;
            }
            disableButtons(true);
            updateBalance(-bet);

            playerHandDiv.innerHTML = '<span>Your Hand</span>: ';
            dealerHandDiv.innerHTML = '<span>Dealer Hand</span>: ';
            
            let pokerDeck = createDeck();
            const playerHand = [];
            const dealerHand = [];
            
            for (let i = 0; i < 5; i++) {
                 playerHand.push(dealCard(pokerDeck));
                 dealerHand.push(dealCard(pokerDeck));
            }
            
            // Render with staggered animation delay
            playerHand.forEach((card, index) => {
                const pCard = document.createElement('span');
                pCard.className = 'card';
                pCard.textContent = `${card.value}${card.suit}`;
                pCard.style.animationDelay = `${index * 0.2}s`;
                playerHandDiv.appendChild(pCard);
            });
            dealerHand.forEach((card, index) => {
                const dCard = document.createElement('span');
                dCard.className = 'card';
                dCard.textContent = `${card.value}${card.suit}`;
                dCard.style.animationDelay = `${(index * 0.2) + 0.3}s`; 
                dealerHandDiv.appendChild(dCard);
            });
            
            await new Promise(resolve => setTimeout(resolve, 2000)); 

            const playerRank = getHandRank(playerHand);
            const dealerRank = getHandRank(dealerHand);
            const result = compareHands(playerRank, dealerRank);

            let win = 0;
            let message = '';
            let type = 'lose';

            const payoutTable = {
                'Pair': 2, 'Two Pair': 3, 'Three of a Kind': 4, 'Straight': 5, 'Flush': 6, 
                'Full House': 8, 'Four of a Kind': 10, 'Straight Flush': 20
            };

            const playerPayout = payoutTable[playerRank.rank] || 1; 

            if (result === 1) { 
                win = bet * playerPayout;
                message = `‚úÖ You win! Your <strong>${playerRank.rank}</strong> beat the Dealer's ${dealerRank.rank}. You won <strong>${win.toLocaleString()}</strong> Credits!`;
                type = 'win';
            } else if (result === 0) { 
                win = bet;
                message = `ü§ù It's a <strong>PUSH</strong>! Both hands tied with <strong>${playerRank.rank}</strong>. Bet returned.`;
                type = 'push';
            } else { 
                 message = `Dealer wins! Your ${playerRank.rank} was beaten by the Dealer's <strong>${dealerRank.rank}</strong>. You lost.`;
                type = 'lose';
            }

            updateBalance(win);
            showResult(resultDiv, message, type);
            disableButtons(false);
            document.getElementById('dealButton').disabled = false;
        }

        // Initial setup
        updateBalance(0); 
    </script>

</body>
</html>